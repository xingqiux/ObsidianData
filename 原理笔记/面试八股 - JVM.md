## 内存模型

### JVM 内存区域划分（堆、栈、方法区）？

**JVM 内存区域划分：**
1. **程序计数器**：线程私有，记录当前线程执行的字节码行号
2. **虚拟机栈**：线程私有，存储**局部变量**表、操作数栈、动态链接、方法出口等
3. **本地方法栈**：线程私有，为 Native 方法服务
4. **堆**：线程共享，**存放对象实例和数组**
5. **方法区**：线程共享，存储已被虚拟机加载的类信息、常量、静态变量等（JDK 8 后为元空间）

## 垃圾回收机制

### 如何判断对象是否可回收（引用计数法、可达性分析）？

**1. 引用计数法**：

- 给对象添加一个引用计数器，被引用时加1，引用失效时减1
- 当计数器为0时回收对象
- 优点：实现简单，效率高
- 缺点：无法解决循环引用问题，JVM 不采用此方法

**2. 可达性分析**：

- 从 GC Roots 开始向下搜索，搜索走过的路径称为引用链
- 当一个对象到 GC Roots 没有任何引用链相连时，判定为可回收
- GC Roots 包括：虚拟机栈中引用的对象、方法区中类静态属性引用的对象、方法区中常量引用的对象、本地方法栈中 JNI 引用的对象

**3. 引用类型**：

- 强引用：普通引用，不会被回收
- 软引用（SoftReference）：内存不足时会被回收
- 弱引用（WeakReference）：下一次 GC 时会被回收
- 虚引用（PhantomReference）：无法通过其获取对象，用于跟踪对象被回收的状态